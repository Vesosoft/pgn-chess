<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <title>Шахматна дъска</title>
    <link rel="stylesheet" href="libs/chessboard-1.0.0.css">
    <style>
        body { margin: 0; padding: 0; }
        #board { width: 500px; margin: auto; }
    </style>
    <script src="libs/chess.js"></script>
    <script src="libs/chessboard-1.0.0.js"></script>
</head>
<body>
    <div id="board"></div>

    <script>
        let board = null;
        const game = new Chess();

        function renderBoard(fen) {
            console.log("[board-frame] Рендирам дъската от FEN:", fen);
            board.position(fen, false);
        }

        function loadPGN(pgn) {
            console.log("[board-frame] Опитвам да заредя PGN...");
            const success = game.load_pgn(pgn);
            console.log("[board-frame] Успех при зареждане?", success);
            renderBoard(game.fen());
        }

        window.addEventListener('message', (event) => {
            console.log("[board-frame] Получих съобщение:", event.data);
            if (event.data.type === 'loadPGN') {
                loadPGN(event.data.data);
            }
        });

        // инициализация на дъската
        document.addEventListener("DOMContentLoaded", () => {
            board = Chessboard('board', {
                position: 'start',
                draggable: false
            });
        });
    </script>
</body>
</html>

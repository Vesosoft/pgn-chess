<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<title>PGN Chess Viewer</title>
<style>
    body {
        margin: 0;
        display: flex;
        flex-direction: column;
        height: 100vh;
    }
    iframe {
        border: none;
    }
    #boardFrame {
        flex: 3;
        min-height: 60%;
    }
    #controlsFrame {
        flex: 1;
        min-height: 40%;
    }
</style>
</head>
<body>

<!-- Дъската -->
<iframe id="boardFrame" src="board-frame.html"></iframe>

<!-- Контролите -->
<iframe id="controlsFrame" src="controls.html"></iframe>

<script>
    const boardFrame = document.getElementById("boardFrame").contentWindow;
    const controlsFrame = document.getElementById("controlsFrame").contentWindow;

    // Приемаме съобщения от контролите и ги пращаме към дъската
    window.addEventListener("message", function(event) {
        if (event.data.type === "loadPGN") {
            console.log("[index] Препращам съобщение към board-frame:", event.data);
            boardFrame.postMessage(event.data, "*");
        }
    });

    // Функция за предварително зареждане на PGN (пример)
    function loadSamplePGN() {
        const samplePGN = `[Event "?"]
[Site "?"]
[Date "2025.04.02"]
[Round "?"]
[White "Veso-Ignatov 73"]
[Black "Player"]
[Result "1-0"]

1. e4 Nc6 2. d4 e5 3. dxe5 Nxe5 4. Nf3 Nxf3+ 5. Qxf3 d6 6. Nc3 c6 7. Bf4 Nf6 8. h3 Be7 9. O-O-O Qc7 10. Qd3 Be6 11. Bxd6 Bxd6 12. Qxd6 Qxd6 13. Rxd6 O-O 14. Be2 Rfd8 15. Rhd1 Rxd6 16. Rxd6 Ne8 17. Rd1 g6 18. f4 a6 19. g4 f5 20. gxf5 gxf5 21. e5 Nc7 22. Be2 Nb5 23. Na4 Nb6 24. Nc5 Bd5 25. Be4 b6 26. Nc5 Nd7 27. Nf6+ Kg7 28. Bd3 Nc6 29. Nxd5 cxd5 30. Rf1 Ne6 31. c3 Nd4 32. Bxf5 d4 33. Be4 Rc8 34. Rf3 Nc6 35. f5 dxc3 36. f6+ Kg7 37. fxe7+ Kf7 38. Bxh7 cxb2+ 39. Kxb2 Rc5 40. Re3 a5 41. Bh7 a4 42. Bf5 b5 43. Re2 Rc3 44. Rc2 a3+ 45. Kb1 Rc3 46. Rc7+ Ke8 47. Rd7+ Kd8 48. Bf5 Rf1+ 49. Kb2 Ra1 50. e6 Ra2+ 51. Kb3 Rb2+ 52. Kb4 a2 53. Bg4+ Ke8 54. e7 Kf8 55. e8=Q+ Kg7 56. Qg6+ Kf6 57. Qg5+ Ke5 58. Rd7# 1-0`;

        console.log("[index] Изпращам примерен PGN към controls");
        controlsFrame.postMessage({ type: "setPGN", data: samplePGN }, "*");
    }

    // Може да извикаш това, за да видиш тестова партия в контролите
    // loadSamplePGN();
</script>

</body>
</html>
